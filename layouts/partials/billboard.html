{{- /*
	h/t to Joe Mooring's answer in
	https://discourse.gohugo.io/t/count-word-function-customized-to-exclude-code/34380
*/ -}}
{{- $wordsToCount := replaceRE `(?s)<div class="highlight">.*?</div>` "" .Content -}}
{{- $wordsToCount = replaceRE `(?s)<details.*?</details>` "" $wordsToCount -}}
{{- $wordsToCount = replaceRE `(?s)<div class="relative imgB.*?"></div>` "" $wordsToCount -}}
{{- $wordsToCount = replaceRE `(?s)<style.*?</style>` "" $wordsToCount -}}
{{- $wordCount := $wordsToCount | countwords -}}
{{- $readingTimeMinsInt := div (float $wordCount) 225 | math.Floor -}}
{{- $readingTime := div (float $wordCount) 225 -}}
{{- $readingTimeMins := $readingTime | math.Ceil -}}
{{- $readingTimeSecs := mul 60 (sub $readingTime $readingTimeMinsInt) | math.Ceil -}}
{{- if ge $readingTimeSecs 60 -}}
	{{- $readingTimeSecs = sub $readingTimeSecs 60 -}}
	{{- $readingTimeMinsInt = add $readingTimeMinsInt 1 -}}
{{- end -}}
{{- $readingTimeSecsInt := printf "%02v" $readingTimeSecs -}}
{{- $wordCountFmt := lang.FormatNumberCustom 0 $wordCount -}}
{{- $contactTitle := "Want to reach me?" -}}
<div class="billboard-div">
	<div class="billboard-title-block">
		<h1 class="billboard-title-text">{{ .Title | .Page.RenderString }}</h1>
		{{- if and .Params.Description (ne .Title .Site.Params.SearchTitle) }}
			<p class="billboard-description-text">
				{{ .Description }}
			</p>
		{{- end }}
		{{- if (and (ne .Title .Site.Params.SearchTitle) (ne .Title "Want to reach me?") ) -}}
			<p class="billboard-p-text" data-pagefind-ignore>
				{{- if ne (substr .Title 0 22) "The site this week: 20" -}}<strong>{{ .PublishDate.Format "2006-01-02" }}</strong>{{- else -}}&nbsp;{{- end -}}
			</p>
			{{/* start, variables for context in non-CI/CD `range` */}}
			{{- $FilePath := .File.Path -}}
			{{- $PubDate := .PublishDate.Format "2006-01-02" -}}
			{{- $Title := .Title -}}
			{{/* end, variables for context in non-CI/CD `range` */}}
			<p class="ctr legal" data-pagefind-ignore>
				{{- if (and (eq .Site.Params.Deploy true) $.GitInfo) -}}
					<a href="https://github.com/brycewray/hugo-site/commit/{{ .GitInfo.Hash }}" title="Latest commit for this page" rel="noopener">Latest commit</a> ({{- if ne (.PublishDate.Format "2006-01-02") (.Lastmod.Format "2006-01-02") }}{{ .Lastmod.Format "2006-01-02" }}{{- else -}}same date{{- end }}) &bull; <a href="https://github.com/brycewray/hugo-site/commits/main/content/{{ .File.Path }}" title="This page’s commit history">History</a>
				{{- else -}}
					{{- range $.Site.Data.gitoutput.gitinfo -}}
						{{- if eq $FilePath .FilePath -}}
							<a href="https://github.com/brycewray/hugo-site/commit/{{ .Hash }}" title="Latest commit for this page" rel="noopener">Latest&nbsp;commit</a> ({{- if ne $PubDate (.LastmodDate | time.Format "2006-01-02") }}{{ .LastmodDate | time.Format "2006-01-02" }}{{- else -}}same date{{- end }}) &bull; <a href="https://github.com/brycewray/hugo-site/commits/main/content/{{ $FilePath }}" title="This page’s commit history">History</a>
						{{- end }}
					{{- end }}
				{{- end }}
				{{- if (and (ne .Title "Want to reach me?") (ne .Title "Privacy policy") ) -}}<br />Reading time: {{ $readingTimeMinsInt }}:{{ $readingTimeSecsInt }} &bull; {{ $wordCountFmt }} words{{- end -}}
			</p>
		{{- end }}
	</div>
</div>
