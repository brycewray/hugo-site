{{- $css := "" -}}
{{- $scssOptions := dict "outputStyle" "compressed" "transpiler" "dartsass" -}}

{{- if eq .Site.Params.Styling "SCSS" -}}
	{{- $scssOptions := merge $scssOptions (dict "targetPath" "critical.css") -}}
	{{- $css = resources.Get "scss/critical.scss" | toCSS $scssOptions -}}
	{{- if hugo.IsProduction -}}
		{{- $css = $css | fingerprint -}}
	{{- end }}
{{- end -}}
{{- if eq .Site.Params.Styling "VCSS" -}}
	{{- $css = (resources.Match "css/partials/0*.css") | resources.Concat "critical.css" -}}
	{{- if hugo.IsProduction -}}
		{{- $css = $css | minify | fingerprint -}}
	{{- end }}
{{- end -}}
{{- with $css }}
	{{/*  <style media="screen">{{ .Content | safeCSS }}</style>  */}}
	<link rel="preload" href="{{ $css.RelPermalink }}" as="style"{{- if hugo.IsProduction -}} integrity="{{ $css.Data.Integrity }}" crossorigin{{- end -}}>
	<link rel="stylesheet" href="{{ $css.RelPermalink }}" type="text/css" media="screen"{{- if hugo.IsProduction -}} integrity="{{ $css.Data.Integrity }}" crossorigin{{- end -}}>
{{- end }}
